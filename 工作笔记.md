# git

 查看远程仓库中所有的分支

```
git remote show 远程仓库名
例如：
git remote show origin
```

查看本地分支

```
git branch 
```

push和fe'tch的地址

```
git remote -v
```

## vscode

1. Commit只会记录您在本地计算机上所做的更改。它不会标记远程存储库中的更改。
2. Commit和Push将执行上述操作并将其推送到远程存储库。这意味着您所做的任何更改也将保存到远程存储库中。
3. 提交和同步做三件事。首先，它会提交本地仓库。其次，它将执行拉动`fetch + merge 或 fetch + rebase`（从远程仓库获取更新的信息）。最后，它会推动`push`。

> 所以是不是可以这样理解：在本地仓库为空的情况下，首次用git pull从远程仓库将最新内容拉到本地仓库&工作区，在工作区更新代码后通过add和commit提交到本地仓库，再次用git fetch+git merge将最新远程仓库内容拉取到本地仓库（可能远程仓库有更新），解决冲突后再git push到远程仓库

------

# npm i  下载安装他人设置好的所有依赖包

```
npm i 
```

> 在同一个项目中使用不同源的npm包，如何使用npm i
>
> 如此板块所言，我们可以创建公司的npm包，且公司的npm地址不同等于npm官方地址，当我们在开发阶段，我们可以使用nrm进行npm源切换，但是问题来了，更为方便的npm i,安装package.json中的依赖，就会报错，导致安装失败；

> 那么，能否在同一个项目中使用npm不同的源呢？

> 当然可以！

> 操作步骤
> 当你创建了一个公司的依赖包，则包名一般为@公司名/包名，示例：@ml/bytedance-sdk-for-node

> 此时，你只需要将自己的npm的配置增加根据某个前缀定向修改源的配置即可，
> 例如：当依赖包前缀为@ml时，使用源地址 ：https://npm.malong360.top/

> npm config set @banu:registry=https://npm.malong360.top/
> **至此，你就可以使用npm i进行安装了；**

> 同时，使用此方法修改依赖包的安装源之后，可以随意使用npm进行安装官方包，以及公司包，不必再使用nrm进行源切换！

> 这个方法适用于日常开发和线上项目部署！

# 拿到别人的vue项目之后如何运行

首先先说情况：

一、你拿到的是别人直接打包好的成品
二、你拿到的是别人给你的源码，里边连依赖（node_modules）都存在的一个超大的压缩包
三、别人放 git 上或者别人把 依赖（node_modules）删除之后给你的一个不大不小的压缩包，源码

来说这三种情况哈：

第一种，直接放你服务器根目录就可以访问了，不用运行，当然，这种的你改也没法改

至于第二种和第三种，首先如果是个小白得话，建议你先看看这篇博文【看看】

知道如何用 vue 创建项目得话，会简单很多

第二种：
在刚才那篇博文里面已经安装好了 vue 运行需要得环境，那么第二种你先将项目里边的 node_modules 文件夹整个删除，然后命令行进入项目根目录，运行 npm install ，等安装好了依赖之后，运行 npm run dev（如果对方没自定义指令的话这个是通用的），这时候项目就跑起来了，命令行有提示当前项目运行的本地地址

第三种：
没有依赖的源码项目，这种的不用考虑，上来先 npm install 一下，再运行 npm run dev ，看命令行启动的地址是什么，直接访问就行

备注：
如何查看自定义指令
找到项目根目录的 package.json 文件，找到 scripts ，里边的就是自定义的指令

比如我这里的：想运行 build 指令，直接在命令行运行 npm run build

![在这里插入图片描述](https://img-blog.csdnimg.cn/e3a08643c6f2483fa2161139f17665a9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Zac5aSn5pmu5aWU4oG24oG24oG2,size_18,color_FFFFFF,t_70,g_se,x_16)

# 输入框失去焦点显示按键，通过按键显示输入框

```vue
<template>

	<input type='text' v-if="inputVisible" @blur="showButton" />
	<button v-else @click="showInput">展示文本框</button>

</template>
<script>
export default{
	data(){
		return{
			inputVisible: false
		}
	},
	methods: {
		showInput(){
			this.inputVisible = true
		},
		showButton(){
			this.inputVisible = false
		}
	}
}
</script>
```

------

# 文字内容超出两行时显示省略号

文字内容超出两行时显示省略号

```html
<view class="newsTitle">
	这里是一条很长很长很长的内容
</view>
```

设置内容超出两行显示省略号的css样式如下：

```js
.newsTitle{
	width: 536rpx;  //设置宽度
	font-size: 32rpx;
	font-weight: 700;
	line-height: 52rpx;
	text-align: left;
	color: #333333;
    
	overflow: hidden;
	text-overflow: ellipsis;
	display: -webkit-box;  //使用自适应布局
	-webkit-line-clamp: 2;  //设置超出行数，要设置超出几行显示省略号就把这里改成几
	-webkit-box-orient: vertical;
}

```

这个样式可用于uniapp的微信小程序开发。

1.语法:text-overflow:clip|ellipsis

默认值:clip;

适用于:所有元素

clip:当前对象内文本溢出时不显示省略标记(...),而是将溢出部分裁剪。

ellipsis:当对象内文本一处时显示省略标记(...)。

当然这还是不够的，需要加点调料才能出现效果:

那就是配合

```css
overflow:hidden

white-space:overflow;
```

2.这时候BT的产品经理来了，小鹏啊~一行省略怎么行，变成三行出现省略。

处理办法:

将white-space去除，并且加上:

```css
display:-webkit-box;

-webkit-line-clamp: 3/*第几行裁剪*/

-webkit-box-orient:vertical;
```

-webkit-line-clamp 用来限制在一个块元素显示的文本的行数。 为了实现该效果，它需要组合其他的WebKit属性。 常见结合属性：
2-1.display: -webkit-box; 必须结合的属性 ，将对象作为弹性伸缩盒子模型显示 。
2-2.-webkit-box-orient 必须结合的属性 ，设置或检索伸缩盒对象的子元素的排列方式 。
2-3.text-overflow: ellipsis; ，可以用来多行文本的情况下，用省略号“…”隐藏超出范围的文本 。

------

# Ant-Design-vue的a-table入门

https://www.jianshu.com/p/ff75f39e3cd0







------

# 【Vue】滚动条（设置滚动条、滚动条样式、鼠标移入滚动条显示移出滚动条隐藏....）

https://blog.csdn.net/Qxn530/article/details/126647153

# 设置滚动条

可以使用overflow属性设置是否出现滚动条。

同时需要指定盒子高度或宽度，当超出指定尺寸时，就会出现滚动条

x、y方向：overflow：[scroll](https://so.csdn.net/so/search?q=scroll&spm=1001.2101.3001.7020)

x方向：overflow-x：scroll

y方向：overflow-y：scroll

```css
.box {
    height: 500px;
    overflow: hidden;// 超出部分隐藏
    overflow-y: scroll; // 设置y轴方向的滚动条
}
```

## 滚动条样式

- ::-[webkit](https://so.csdn.net/so/search?q=webkit&spm=1001.2101.3001.7020)-scrollbar 滚动条整体部分
- ::-webkit-scrollbar-button 滚动条两端的按钮
- ::-webkit-scrollbar-track 外层轨道
- ::-webkit-scrollbar-track-piece 内层轨道，滚动条中间部分（除去）
- ::-webkit-scrollbar-thumb 滚动条里面可以拖动的那个
- ::-webkit-scrollbar-corner 边角
- 
  ::-webkit-resizer 定义右下角拖动块的样式

### 1、隐藏滚动条

```css
// 隐藏滚动条
 .el-tab-pane::-webkit-scrollbar {
   width: 0 !important;
   height: 0px !important;
 }
```

### 2、常用滚动条的样式的示例

 ![img](https://img-blog.csdnimg.cn/a311ac8a2a614fc4b77ca19e00a616f9.png)

```css
.box {
    padding: 30px 20px 30px 50px;
    height: 500px;
    overflow: hidden;
    white-space: nowrap
    overflow-y: scroll;// 设置滚动条
 
  /*定义滚动条宽高及背景，宽高分别对应横竖滚动条的尺寸*/
  // 滚动条整体部分
  &::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  // 滚动条的轨道的两端按钮，允许通过点击微调小方块的位置。
  &::-webkit-scrollbar-button {
    display: none;
  }
  // 滚动条里面的小方块，能向上向下移动（或往左往右移动，取决于是垂直滚动条还是水平滚动条）
  &::-webkit-scrollbar-thumb {
    background: rgba(144, 147, 153, 0.3);
    cursor: pointer;
    border-radius: 4px;
  }
  // 边角，即两个滚动条的交汇处
  &::-webkit-scrollbar-corner {
    display: none;
  }
  // 两个滚动条的交汇处上用于通过拖动调整元素大小的小控件
  &::-webkit-resizer {
    display: none;
  }
 
}
```

## 滚动条的应用

### 1、标签页的内容滚动，标签头部固定

只要修改css样式：给元素添加高度和overflow：auto或给父元素添加即可

子盒子的高度需要根据屏幕自适应

```vue
<template>
  <div class="app-container">
    <el-tabs v-model="activeName">
      <el-tab-pane label="用户管理" name="first">用户管理</el-tab-pane>
      <el-tab-pane label="配置管理" name="second">配置管理</el-tab-pane>
      <el-tab-pane label="角色管理" name="third">角色管理</el-tab-pane>
    </el-tabs>
  </div>
</template>
 
 
<style lang='scss' scoped>
.el-tab-pane {
  height: 500px;
  overflow-y: auto;
}
</style>
```

### ***\*2、鼠标移入显示滚动条，鼠标移出隐藏滚动条\****

```html
<div class="table"></div>
 
<style lang='scss' scoped>
.table {
  height: 700px;
  overflow: hidden;
}
.table:hover {
  height: 700px;
  overflow-y: auto;
}
</style>
```

### 3、***\*实现导航栏鼠标上滑显示下滑隐藏\****

首先我们要在DOM加载完毕之后获取滚轮事件，把滚轮位置赋值给data中的top变量，用watch[监听](https://so.csdn.net/so/search?q=监听&spm=1001.2101.3001.7020)top的newValue和oldValue值，当新值比旧值大的时候证明滚轮在向下滚动，触发相对应事件，反之亦然。

```vue
<!-- 第一步 -->
<navbar id="nav-bar" :class="navShow ? 'navOn' : 'navOff'" />
 
<script>
  //第三步： 获取浏览器滚轮
  mounted () {
    window.addEventListener('scroll', () => {
      this.top = document.documentElement.scrollTop || document.body.scrollTop || window.pageYOffset
    })
  },
  //第四步： 监听top值的变化
  watch: {
    top (newValue, oldValue) {
      // 等新值大于100的时候再做变化（优化一下）
      if (newValue > 100) {
        if (newValue > oldValue) {
          this.navShow = false
          console.log('向下滚动')
        } else {
          this.navShow = true
          console.log('向上滚动')
        }
      }
    }
  },
  data () {
     return {
        // 第二步
        top: '',
        navShow: true,
      }
  },
}
</script>
<style lang="scss" scoped>
// 第五步
.navOn {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  transition: all 0.2s ease-in-out 0.2s;
  transform: translateZ(0);
  z-index: 9;
}
.navOff {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  transition: all 0.2s ease-in-out 0.2s;
  transform: translate3d(0, -100%, 0);
  z-index: 9;
}
</style>
```

### 4、表格中的滚动条（空白处理）

![img](https://img-blog.csdnimg.cn/7598ffc674b54cb2be5daf4fcd6ed31b.png)

```css
 //滚动条空白
  //表头
  .el-table--border th:last-child {
    border-right: none;
  }
  .el-table__fixed-right-patch {
    // background-color: #152345 !important; //如果表头有背景色，在这里添加即可
  }
 
 //表格内容处
 .el-table td:last-child {
    border-right: none;
  }
```

最后的效果就是这样啦，没有什么特别好的方法，如果你有的话留言一下呗。

![img](https://img-blog.csdnimg.cn/ca21fa3a1f024787a5c376fabe7a97b2.png)

------

# 提高样式优先级

!important

```css
.ant-tabs-extra-content {
  float: left !important;
  position: absolute;
}
```



------

# Vue项目中的接口调用

在企业开发过程中，往往有着明确的前后端的分工，前端负责接收、使用接口，后端负责编写、处理接口。

对于前端如何使用接口，今天在Vue中进行讲解。

一个项目往往由这几个部分组成。

![在这里插入图片描述](https://img-blog.csdnimg.cn/e07ffc1875ba4431ba4974453ba194e7.png)

其中在src文件夹中，有这么些内容。

![在这里插入图片描述](https://img-blog.csdnimg.cn/ce69167d478b41d3919513a6c6bfef1e.png)

我们常常把接口文件，新建一个文件夹在src下，命名为[api](https://so.csdn.net/so/search?q=api&spm=1001.2101.3001.7020)，api内的文件便是接口文件。

![在这里插入图片描述](https://img-blog.csdnimg.cn/4d0e8e7cb6314c8c9fc9525a3f89d1a1.png)

通常把后端的接口写在api文件夹下，自己命名为xxx.js

```js
// 登录
export function login(data) {
  return request({
    url: '/api/court/login',
    method: 'post',
    data
  })
}
// 获取验证码
export function captchaImage(params) {
  return request({
    url: '/api/captchaImage',
    method: 'get',
    params
  })
}

```

对于需要添加信息在头部的，可以这么写

```js
// 获取登录用户信息
export function getInfo(params) {
  return request({
    url: '/api/court/getInfo',
    method: 'get',
    params,
    headers: {
      'Authorization': JSON.parse(localStorage.Authorization)
  }
  })
}

```

![在这里插入图片描述](https://img-blog.csdnimg.cn/d175abf6010243b7af7829fa2d3792c7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_20,color_FFFFFF,t_70,g_se,x_16)

这个就是request.js 文件的内容

![在这里插入图片描述](https://img-blog.csdnimg.cn/1729607db8c34869ba4c78b8fd797eb3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_18,color_FFFFFF,t_70,g_se,x_16)

```js
import axios from 'axios'
// import { getToken } from '@/utils/auth'

// create an axios instance
const service = axios.create({
  // 外网更新
  // baseURL: 'http://xxxxx',
  baseURL: '/xxxxx',  
  timeout: 5000 // request timeout
})

export default service

```

项目的页面往往写在views中，每个页面设一个文件夹，其中index.vue 内容则是本页面的内容

![在这里插入图片描述](https://img-blog.csdnimg.cn/e1bef25f73ea4d8094ab678fb94d6757.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_20,color_FFFFFF,t_70,g_se,x_16)

在页面中，如果我们需要使用某个接口。则需要进行引入操作。通过 import {接口名1、接口名2} from ’ api文件地址 ’

```js
import { login,captchaImage,getInfo,logOut,reset } from '@/api/login'

```

from后所跟的就是api中文件的地址路径

接口往往是在方法中进行调用，对于不同接口 ，需要的参数也不一样，根据需求，我们传入对应的参数即可。图中的 captchaImage、以及login就是接口信息。

接口的使用格式：

接口名({参数1:页面中的参1，参数2：页面中的参数2}).then(res => {
console.log(res)//res就是调用接口后，后台返回过来的结果，一般数据储存在res.data.data中，具体情况而论

![在这里插入图片描述](https://img-blog.csdnimg.cn/de131c8dd9614722a3c46827d13504ca.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_20,color_FFFFFF,t_70,g_se,x_16)

这样就是接口调用的全部过程了。附上控制台信息图以及apipost接口图。

![在这里插入图片描述](https://img-blog.csdnimg.cn/14c65c554a8e4263b5ffc1edb29f1efc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_20,color_FFFFFF,t_70,g_se,x_16)

![在这里插入图片描述](https://img-blog.csdnimg.cn/e35ac014af244b939d8495d09566ef43.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/f2bb9a15ab3d47f29a61c6c53b193813.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5oiR6KaB5b2T5YmN56uv5bel56iL5biI,size_20,color_FFFFFF,t_70,g_se,x_16)

------

# 表格功能

### 效果：

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-02_16-48-50.png)

### 注意1：数据`list`结构

> 第一个 a-form-model 控制表格个数，每次新增会在列表 list 中push一个对象（包含时间和能否编辑，还有一个包含数据"里程、自提、配送左右俩数字"的列表，对象内新增对象），
>
> list：[ { 规则1：时间，[ {规则数据第一行} ] }，{ 规则2 }，{ 规则3 } ]

```js
list：[  { 规则1：时间，[ {规则数据第一行} ，{规则数据第二行}  ] } , { 规则2 } , { 规则3 }  ]

list:[
	{   //规则1
		key: this.$_.uniqueId(),
        edit: true,
        pickTimeBegin: pickTimeBeginMoment.format('HH:mm'),
        pickTimeEnd: pickTimeEndMoment.format('HH:mm'),
        pickTimeBeginMoment,
        pickTimeEndMoment,
        ruleList: [
        	{	//行内数据 第一行
        		key: this.$_.uniqueId(),
        		mileageLeft: '',
        		mileageRight: '',
        		selfDateLeft: '0',
        		selfDateRight: '0',
        		deliveryDateLeft: '0',
        		deliveryDateRight: '0',
      		},
      		{  //第二行
      		...
      		},
        ],
	},
	{  //规则2
	...
	}
]
```

### 注意2：

required是做什么用的:这个是加了后，label前面会有星号,这个不会触发校验

![image-20221103143118213](C:\Users\shizeyu\AppData\Roaming\Typora\typora-user-images\image-20221103143118213.png)

在rules里面配置，也会有星号，但是会触发校验了

![image-20221103143222251](C:\Users\shizeyu\AppData\Roaming\Typora\typora-user-images\image-20221103143222251.png)

### 注意3：时间使用moment来实现

包括现在时间`this.$moment()`，判断末端时间是否在起始时间前：isSameOrAfter()

moment().isSameOrAfter(Moment|String|Number|Date|Array); moment().isSameOrAfter(Moment|String|Number|Date|Array, String);

> 检查一个 moment 是否在另一个 moment 之后或与之相同。 第一个参数会被解析为 moment（如果尚未解析）。

```
moment('2010-10-20').isSameOrAfter('2010-10-19'); // true
moment('2010-10-20').isSameOrAfter('2010-10-20'); // true
moment('2010-10-20').isSameOrAfter('2010-10-21'); // false
```

### 注意4：引用全局函数js来判断是否非空

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-04_15-04-58.png)

> 详解查看Vue的`Vue.prototype`详解	

### 注意5：全局提示实现

在main.js中添加全局 ant-design-vue方法组件 message ，然后通过this.$message调用。具体查看ant-design-vue文档

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-04_15-27-36.png)

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-04_15-40-14.png)

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-04_15-39-39.png)

常用方法：（包括成功、失败、警告。

```vue
<template>
  <div>
    <a-button @click="success">
      Success
    </a-button>
    <a-button @click="error">
      Error
    </a-button>
    <a-button @click="warning">
      Warning
    </a-button>
  </div>
</template>
<script>
export default {
  methods: {
    success() {
      this.$message.success('This is a success message');
    },
    error() {
      this.$message.error('This is an error message');
    },
    warning() {
      this.$message.warning('This is a warning message');
    },
  },
};
</script>

```











### 代码：

| allowClear | 是否展示清除按钮      | boolean | true                  |
| ---------- | --------------------- | ------- | --------------------- |
| openChange | 面板打开/关闭时的回调 |         | (open: boolean): void |

```vue
<!-- 里程区间组件 -->
<template>
  <div class="config">
    <a-button v-if="isPlan" type="primary" class="config-add" @click.stop="addForm">新增规则</a-button>
    <a-form-model v-for="(item, index) in list" :key="item.key" labelAlign="left" class="config-form">
      <template v-if="isPlan">
        <a v-if="list.length > 1" class="config-form-delete delete-icon" @click.stop="list.splice(index, 1)" />
        <a-form-model-item label="下单时间" :required="true">
          <a-time-picker v-model="item.pickTimeBeginMoment" format="HH:mm" :allowClear="false"
                         @change="changePickTime(item)" />
          <span class="config-form-interval all-center">~</span>
          <!-- 第一个disabledHours是组件的禁用API，第二个是调用事件 -->
          <a-time-picker v-model="item.pickTimeEndMoment" format="HH:mm" :allow-clear="false"
                         :disabledHours="() => disabledHours(item)" :disabledMinutes="() => disabledMinutes(item)"
                         @openChange="changePickTime(item)" />
        </a-form-model-item>
      </template>
      <template v-if="item.edit">
        <a-button type="primary" @click.stop="addRule(item)">添加里程区间</a-button>
        <template v-if="isPlan || isInventoryEdit">
          <a-button type="primary" @click.stop="saveRule(item, index)">保存</a-button>
          <a-button v-if="!$isEmpty(data[index]) && !$isEmpty(data[index].ruleList)"
                    @click.stop="cancelRule(item, index)">
            取消
          </a-button>
        </template>
      </template>
      <a-button v-else key="edit" type="primary" @click.stop="item.edit = true">修改</a-button>
      <a-table :columns="columns" :dataSource="item.ruleList" :bordered="true" :pagination="false">
        <template slot="mileage" slot-scope="text, record, rowIndex">
          <div class="all-center">
            <template v-if="item.edit">
              <a-input-number v-model="record.mileageLeft" :min="0" />
              &nbsp;&nbsp;&lt;&nbsp;&nbsp;里程&nbsp;&nbsp;≤&nbsp;&nbsp;
              <a-input-number v-model="record.mileageRight" :min="0" />
            </template>
            <template v-else>
              {{ record.mileageLeft }}
              <template v-if="!$isEmpty(record.mileageLeft)">&lt;&nbsp;&nbsp;</template>
              <span>里程</span>
              <template v-if="!$isEmpty(record.mileageRight)">&nbsp;&nbsp;≤</template>
              {{ record.mileageRight }}
            </template>
            <a v-if="item.edit && item.ruleList.length > 1" class="config-row-delete delete-icon"
               @click.stop="item.ruleList.splice(rowIndex, 1)" />
          </div>
        </template>
        <template slot="since" slot-scope="text, record">
          <div class="all-center">
            <template v-if="item.edit">
              <a-input-number v-model="record.selfDateLeft" :min="0"
                              @blur.stop="numberInputBlur(record, 'selfDateLeft')" />
              <template v-if="isPlan">
                &nbsp;&nbsp;~&nbsp;&nbsp;
                <a-input-number v-model="record.selfDateRight" :min="0"
                                @blur.stop="numberInputBlur(record, 'selfDateRight')" />
              </template>
            </template>
            <template v-else>
              {{ record.selfDateLeft }}
              <template v-if="isPlan">
                &nbsp;&nbsp;~&nbsp;&nbsp;
                {{ record.selfDateRight }}
              </template>
            </template>
          </div>
        </template>
        <template slot="delivery" slot-scope="text, record">
          <div class="all-center">
            <template v-if="item.edit">
              <a-input-number v-model="record.deliveryDateLeft" :min="0"
                              @blur.stop="numberInputBlur(record, 'deliveryDateLeft')" />
              <template v-if="isPlan">
                &nbsp;&nbsp;~&nbsp;&nbsp;
                <a-input-number v-model="record.deliveryDateRight" :min="0"
                                @blur.stop="numberInputBlur(record, 'deliveryDateRight')" />
              </template>
            </template>
            <template v-else>
              {{ record.deliveryDateLeft }}
              <template v-if="isPlan">
                &nbsp;&nbsp;~&nbsp;&nbsp;
                {{ record.deliveryDateRight }}
              </template>
            </template>
          </div>
        </template>
      </a-table>
    </a-form-model>
  </div>
</template>

<script>
export default {
  name: 'ruleConfig',
  props: {
    data: {
      type: Array,
      default: () => [],
    },
    type: { // 0：计划判断，1：库存配置新增、2：库存配置修改
      type: String,
      default: '0',
    },
  },
  data() {
    return {
      list: [],
      columns: [
        { title: '里程区间（公里）', width: 300, scopedSlots: { customRender: 'mileage' } },
        { title: '自提（计划提货日期+ x 天）', width: 300, scopedSlots: { customRender: 'since' } },
        { title: '配送（期望到货日期-x 天）', width: 300, scopedSlots: { customRender: 'delivery' } },
      ],
    };
  },
  computed: {
    isPlan() {
      return this.type === '0';
    },
    isInventoryEdit() {
      return this.type === '2';
    },
  },
  methods: {
    init() {
      if (this.$isEmpty(this.data)) {
        this.addForm();
      } else {
        this.list = this.data.map(item => ({
          ...item,
          key: item.id || this.$_.uniqueId(),
          edit: item.edit || this.$isEmpty(item.ruleList),
          mileageLeft: this.$isEmpty(item.mileageLeft) ? '' : parseFloat(item.mileageLeft),
          mileageRight: this.$isEmpty(item.mileageRight) ? '' : parseFloat(item.mileageRight),
          pickTimeBeginMoment: this.$moment(item.pickTimeBegin, 'HH:mm'),
          pickTimeEndMoment: this.$moment(item.pickTimeEnd, 'HH:mm'),
          ruleList: item.edit ? item.ruleList : this.initRuleList(item.ruleList),
        }));
      }
    },
    initRuleList(ruleList) {
      return ruleList.map(item => {
        const [selfDateLeft, selfDateRight] = item.selfDate?.toString()?.split('-') || ['0', '0'];
        const [deliveryDateLeft, deliveryDateRight] = item.deliveryDate?.toString()?.split('-') || ['0', '0'];

        return {
          ...item,
          key: item.id || this.$_.uniqueId(),
          selfDateLeft,
          selfDateRight,
          deliveryDateLeft,
          deliveryDateRight,
        };
      });
    },
    addForm() { //增加规则
      const pickTimeBeginMoment = this.$moment();
      const pickTimeEndMoment = this.$moment().add(1, 'h');
      const item = {
        key: this.$_.uniqueId(),
        edit: true,
        pickTimeBegin: pickTimeBeginMoment.format('HH:mm'),
        pickTimeEnd: pickTimeEndMoment.format('HH:mm'),
        pickTimeBeginMoment,
        pickTimeEndMoment,
        ruleList: [],
      };
      this.addRule(item); //增加规则内的行数
      this.list.push(item); //规则并入 list列表
    },
    disabledHours(item) {	// 禁用起始时间之前的小时选项
      const hours = item.pickTimeBeginMoment.hours();
      const disabled = [];	// 禁用列表
      for (let i = 0; i < hours; i++) {
        disabled.push(i);
      }

      if (item.pickTimeBeginMoment.minutes() === 59) {
        disabled.push(hours);
      }

      return disabled;
    },
    disabledMinutes(item) {
      if (item.pickTimeBeginMoment.hours() === item.pickTimeEndMoment.hours()) {
        const disabled = [];
        for (let i = 0; i < item.pickTimeBeginMoment.minutes() + 1; i++) {
          disabled.push(i);
        }

        return disabled;
      }

      return [];
    },
    changePickTime(item) {  	// 每次下单时间变化引发事件判断是否末端时间小于起始时间
      if (item.pickTimeBeginMoment.isSameOrAfter(item.pickTimeEndMoment)) {
        item.pickTimeEndMoment = this.$moment(item.pickTimeBeginMoment).add(1, 'h');	// 若末端时间小于起始时间，则 末时间等于起始加1，使用moment的add必须用 moment().add() 语法
      }
      item.pickTimeBegin = item.pickTimeBeginMoment.format('HH:mm');	// 同样也要更改pickTimeBegin的值
      item.pickTimeEnd = item.pickTimeEndMoment.format('HH:mm');
    },
    numberInputBlur(item, key) {
      if (this.$isEmpty(item[key])) {
        item[key] = 0;
      }
    },
    addRule(item) {  	// 默认规则第一行数据
      item.ruleList.push({
        key: this.$_.uniqueId(),
        mileageLeft: '',
        mileageRight: '',
        selfDateLeft: '0',
        selfDateRight: '0',
        deliveryDateLeft: '0',
        deliveryDateRight: '0',
      });
    },
    saveRule(item) {	// 保存事件
      if (this.checkRule(item.ruleList)) {	// 判断
        item.ruleList = item.ruleList.map(item => ({
          ...item,
          selfDate: this.isPlan ? `${item.selfDateLeft}-${item.selfDateRight}` : item.selfDateLeft,
          deliveryDate: this.isPlan ? `${item.deliveryDateLeft}-${item.deliveryDateRight}` : item.deliveryDateLeft,
        }));

        if (this.$dataType.isFunction(this.$listeners.onSave)) {
          this.$emit('onSave', item.ruleList, () => {
            item.edit = false;
            this.$emit('update:data', this.list);
          });
        } else {
          item.edit = false;
          this.$emit('update:data', this.list);
        }
      }
    },
    checkRule(ruleList) {	// 
      const { length } = ruleList;

      for (let i = 0; i < length; i++) {	// 循环当前规则的每一行数据
        const { mileageLeft, mileageRight } = ruleList[i];	// 赋值解构出 里程左值和右值
        const hasNotMileageLeft = this.$isEmpty(mileageLeft);	// 判断是否为空，空true
        const hasNotMileageRight = this.$isEmpty(mileageRight); // 同上

        if (hasNotMileageLeft && hasNotMileageRight) {	// 若同时为空值则弹出报错返回给saveRule事件false
          this.$message.warning('请输入里程最小值或里程最大值');
          return false;
        }

        if (!hasNotMileageLeft && !hasNotMileageRight && mileageLeft >= mileageRight) { 
          this.$message.warning('里程最小值不能大于或等于里程最大值');
          return false;
        }

        const $mileageLeft = this.$isEmpty(mileageLeft) ? -window.Infinity : mileageLeft + 1;
        const $mileageRight = this.$isEmpty(ruleList[i].mileageRight) ? window.Infinity : mileageRight;
        for (let j = 0; j < length; j++) {
          const _mileageLeft = this.$isEmpty(ruleList[j].mileageLeft) ? -window.Infinity : ruleList[j].mileageLeft + 1;
          const _mileageRight = this.$isEmpty(ruleList[j].mileageRight) ? window.Infinity : ruleList[j].mileageRight;

          if (i !== j && Math.max($mileageLeft, _mileageLeft) <= Math.min($mileageRight, _mileageRight)) {
            this.$message.warning('里程区间不可重复');
            return false;
          }
        }
      }

      return true;
    },
    cancelRule(item, index) {
      item.edit = false;
      item.ruleList = this.initRuleList(this.data[index].ruleList);
    },
    getRuleList() {
      const { length } = this.list;
      for (let i = 0; i < length; i++) {
        if (!this.checkRule(this.list[i].ruleList)) {
          return false;
        }

        const pickTimeBegin = this.$moment(this.list[i].pickTimeBeginMoment.format('HH:mm'), 'HH:mm').valueOf();
        const pickTimeEnd = this.$moment(this.list[i].pickTimeEndMoment.format('HH:mm'), 'HH:mm').valueOf();
        for (let j = 0; j < length; j++) {
          const _pickTimeBegin = this.$moment(this.list[j].pickTimeBeginMoment.format('HH:mm'), 'HH:mm').valueOf();
          const _pickTimeEnd = this.$moment(this.list[j].pickTimeEndMoment.format('HH:mm'), 'HH:mm').valueOf();

          if (i !== j && Math.max(pickTimeBegin, _pickTimeBegin) <= Math.min(pickTimeEnd, _pickTimeEnd)) {
            this.$message.warning('时间区间不可重复');
            return false;
          }
        }
      }

      return this.list;
    },
  },
  watch: {
    data: {
      immediate: true,
      handler() {
        this.init();
      },
    },
  },
};
</script>

<style lang="scss" scoped>
.config {
  .ant-btn {
    min-width: 68px;
    font-size: 12px;
    margin-bottom: 12px;

    &.config-add {
      width: 102px;
    }

    &:not(.ant-btn-primary) {
      background-color: transparent;
    }

    & + .ant-btn {
      margin-left: 8px;
    }
  }

  .config-form {
    position: relative;
    padding: 16px;
    background-color: #f7f7f7;

    & + .config-form {
      margin-top: 8px;
    }

    .delete-icon {
      position: absolute;
      z-index: 1;
      width: 16px;
      height: 16px;

      &.config-form-delete {
        top: 24px;
        right: 17px;
        background: url(../../assets/imager/delete_red_close.png) no-repeat;
        background-size: 100% 100%;
      }

      &.config-row-delete {
        top: 50%;
        left: 10px;
        background: url(../../assets/imager/delete_red_minus.png) no-repeat;
        background-size: 100% 100%;
        transform: translate(0, -50%);
      }
    }

    .ant-time-picker {
      width: 112px;
    }

    .config-form-interval {
      display: inline-flex;
      width: 16px;
    }

    /deep/ .ant-form-item-label {
      width: 94px;

      label {
        color: #333;
        font-size: 14px;
      }
    }

    /deep/ .ant-table {
      .ant-table-thead {
        th {
          height: 30px;
          text-align: center !important;
          padding: 0;
          border-bottom: none;
          background-color: #f7f7f7 !important;
        }
      }

      .ant-table-tbody {
        td {
          position: relative;
          height: 52px;
          border-color: #d8d8d8;
          border-bottom: none;
          background-color: #fff;
          box-shadow: inset 0px -1px 0 0 #d9d9d9;
        }
      }
    }
  }
}
</style>

```

判断是否为空：

```js
// 判断是否为空
export const isEmpty = value => {
  switch (dataType.getType(value)) {
    case 'Set':
    case 'Map':
      return value.size === 0;
    case 'Object':
      return Object.keys(value).length === 0;
    case 'Array':
      return value.length === 0;
    default:
      return ['', null, undefined].includes(value);
  }
};

// 获取数据类型
const getType = value => Object.prototype.toString.call(value).slice(8, -1);

// 数据类型操作
export const dataType = {
  getType,
  isMap: value => getType(value) === 'Map',
  isSet: value => getType(value) === 'Set',
  isObject: value => getType(value) === 'Object',
  isArray: value => getType(value) === 'Array',
  isFunction: value => getType(value) === 'Function',
  isDate: value => getType(value) === 'Date',
  isReg: value => getType(value) === 'RegExp',
  isString: value => getType(value) === 'String',
  isNumber: value => getType(value) === 'Number',
  isBoolean: value => getType(value) === 'Boolean',
  isNull: value => getType(value) === 'Null',
  isUndefined: value => getType(value) === 'Undefined',
};
```

message弹窗

> 使用的是ant-design-vue的message组件

![](C:\Users\shizeyu\Desktop\notes\Ajax-vue\Snipaste_2022-11-04_15-27-36.png)









------

# 实现星号

required是做什么用的:这个是加了后，label前面会有星号,这个不会触发校验

![image-20221103143118213](C:\Users\shizeyu\AppData\Roaming\Typora\typora-user-images\image-20221103143118213.png)

在rules里面配置，也会有星号，但是会触发校验了

![image-20221103143222251](C:\Users\shizeyu\AppData\Roaming\Typora\typora-user-images\image-20221103143222251.png)













------

# LNG窗口期

